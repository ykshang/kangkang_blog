# 4、Webpack，如何去优化生产环境运行性能？

#### 1、设置为生产模式，webpack 自动使用优化选项

在生产模式下，`webpack`会自动启用一些优化选项，包括：**缓存**、**Tree Shaking**、**html 代码压缩**、**js 代码压缩**。

#### 2、优化代码拆分策略，实现按需加载

控制打包后生成的文件的数量和体积。从而实现**只加载必要的**，**有需求再加载**，提高一些关键的性能指标。主要三个手段：**调整拆分颗粒度**，**路由、复杂组件懒加载**，**缓存组提取公共代码和第三方依赖包**

#### 3、提高哈希值的复杂度，提高缓存命中率

在 **避免哈希碰撞** 的情况下，对生成的打包文件采用**更复杂的哈希值计算**，可以有效降低打包的影响范围，从而利用浏览器的缓存，**提高缓存命中率**

#### 4、代码压缩，减小体积

压缩 html，js，css 代码，控制体积

#### 5、静态资源合并、压缩、转化

压缩视频图片画质；多个小图片合并成一个大图片；或者使用字体图标库；上传资源到静态资源服务器

#### 6、优化 css、js 的兼容性

使用`postCss`去处理`CSS`的兼容性；使用`babel`和`core-js`去处理 js 的兼容性

#### 7、关闭或降低 sourceMap 的生成精度

减小 map 文件大小，提高加载速度

#### 8、使用 PWA 技术优化体验

PWA 可以让用户在突然断网的情况下，依然可以访问已经加载过的资源。

#### 9、其他

- **CDN、静态资源服务器：** 一些大体积的图片、视频、字体文件、第三方的库

- **使用 ES 模块化按需引入：** 引入第三方包的时候，使用需要的部分

- **路由、复杂组件的懒加载：** 懒加载配合魔法名称，可以告诉 webpack 单独拆分。
