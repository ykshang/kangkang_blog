# 6、如何区分和配置开发环境和生产环境？

**在 Webpack 中，可以通过配置不同的 Webpack 配置文件或统一的配置文件来区分开发环境和生产环境的配置。**

一种常见的做法是**创建两个独立的 Webpack 配置文件，分别针对开发环境和生产环境进行配置**。一般来说，开发环境的配置更侧重于开发体验和调试工具，而生产环境的配置则更关注代码优化、压缩和资源的优化。

> 例如，可以创建以下两个 Webpack 配置文件：

### 1. `webpack.config.dev.js`（开发环境配置文件）

```javascript
const webpack = require("webpack");
const HtmlWebpackPlugin = require("html-webpack-plugin");

module.exports = {
  mode: "development",
  entry: "./src/index.js",
  output: {
    filename: "bundle.js",
    path: path.resolve(__dirname, "dist"),
  },
  devServer: {
    port: 3000,
    hot: true,
  },
  plugins: [
    new HtmlWebpackPlugin({
      template: "./public/index.html",
    }),
  ],
};
```

### 2. `webpack.config.prod.js`（生产环境配置文件）

```javascript
const webpack = require("webpack");
const HtmlWebpackPlugin = require("html-webpack-plugin");
const MiniCssExtractPlugin = require("mini-css-extract-plugin");
const TerserWebpackPlugin = require("terser-webpack-plugin");

module.exports = {
  mode: "production",
  entry: "./src/index.js",
  output: {
    filename: "bundle.js",
    path: path.resolve(__dirname, "dist"),
  },
  optimization: {
    minimizer: [new TerserWebpackPlugin()],
  },
  plugins: [
    new HtmlWebpackPlugin({
      template: "./public/index.html",
      minify: {
        collapseWhitespace: true,
        removeComments: true,
        removeRedundantAttributes: true,
        useShortDoctype: true,
      },
    }),
    new MiniCssExtractPlugin({
      filename: "styles.css",
    }),
  ],
};
```

在此示例中，开发环境的配置文件仅包含了开发服务器（`devServer`）和热模块替换（`hot module replacement`）的配置，而生产环境的配置文件则包含了代码压缩（`TerserWebpackPlugin`）和 CSS 提取（`MiniCssExtractPlugin`）等插件的配置。

另一种做法是使用同一个配置文件，并在其中根据环境变量来判断不同的配置。可以使用`webpack-merge`工具来合并共享的配置和环境特定的配置。以下是一个示例：

```javascript
const webpackMerge = require("webpack-merge");
const commonConfig = require("./webpack.config.common");

module.exports = (env) => {
  const envConfig = require(`./webpack.config.${env}.js`);
  return webpackMerge(commonConfig, envConfig);
};
```

在此示例中，`webpack.config.common.js`是共享的基本配置文件，而`webpack.config.dev.js`和`webpack.config.prod.js`分别是开发环境和生产环境的特定配置文件。根据传入的环境变量，可以决定加载哪个环境的配置文件。

在命令行中使用 Webpack 时，可以通过设置环境变量来指定所需的配置文件，例如：

```shell
webpack --config webpack.config.js --env production
```

以上是一些常见的配置不同环境的方法，你可以根据自己的需求选择适合的方式来配置 Webpack 的开发环境和生产环境。
