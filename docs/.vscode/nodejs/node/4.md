# NPM、PNPM、Yarn 的对比

在前端开发中，包管理工具是不可或缺的一部分，它们帮助我们轻松管理项目依赖、发布和共享代码。NPM、PNPM、Yarn 是目前最流行的包管理工具，但它们各有特点和使用场景。本文将深入解析这三大包管理工具，帮助你选择最适合自己项目的工具。

## 一、NPM（Node Package Manager）

### 1.1、NPM 简介

NPM 是 Node.js 的默认包管理工具，也是最早出现的 JavaScript 包管理工具。随着 Node.js 的流行，NPM 也成为了前端开发中最广泛使用的包管理工具之一。

### 1.2、NPM 的主要功能

- **管理项目依赖：** 通过 `package.json` 文件记录项目所需的依赖包，并通过 `npm install` 安装。
- **发布与共享包：** 开发者可以通过 NPM 将自己的包发布到 `NPM Registry`，供其他开发者使用。
- **脚本管理：** 可以在 `package.json` 中定义脚本，通过 `npm run <script>` 运行。

### 1.3、NPM 的优缺点

#### 优点：

- **广泛使用：** NPM 是默认的包管理工具，社区庞大，几乎所有 Node.js 项目都支持。
- **丰富的包资源：** NPM Registry 是世界上最大的包管理库，拥有超过一百万个包。

#### 缺点：

- **速度较慢：** 由于历史原因，NPM 的安装速度相对较慢。
- **重复安装：** 在不同的项目中，NPM 会为每个项目单独下载依赖包，可能导致磁盘空间的浪费。

## 二、Yarn

### 2.1、Yarn 简介

Yarn 是由 Facebook 在 2016 年推出的包管理工具，旨在解决 NPM 的一些性能和安全问题。Yarn 在保证兼容 NPM 的基础上，引入了一些新特性，提升了包管理的效率和可靠性。

### 2.2 Yarn 的主要功能

- **并行安装：** Yarn 在安装依赖时，会并行下载包，大幅提升安装速度。

- **锁定文件：** Yarn 使用 `yarn.lock` 文件锁定依赖的版本，确保团队中每个人安装的依赖版本一致。
- **缓存机制：** Yarn 使用缓存机制，已经下载过的包会被缓存，下一次安装时无需重新下载。

### 2.3 Yarn 的优缺点

#### 优点：

- **速度快：** Yarn 的并行安装和缓存机制显著提升了安装速度。
- **确定性安装：** 通过锁定文件，确保每次安装的依赖包版本一致，减少了“它在我机器上能跑”的问题。

#### 缺点：

- **学习成本：** 对于已经习惯使用 NPM 的开发者，切换到 Yarn 可能需要一段时间的适应。
- **社区资源：** 虽然 `Yarn` **兼容** `NPM`，但某些工具或包可能对 Yarn 的支持不如 NPM 完善。

## 三、PNPM

### 3.1 PNPM 简介

PNPM 是一种更现代的包管理工具，采用了独特的“硬链接”技术，极大地节省了磁盘空间，并提升了安装速度。PNPM 的出现为开发者提供了一种更高效的依赖管理方式。

### 3.2 PNPM 的主要功能

- **硬链接技术：** PNPM 通过 [**硬链接**](./6)<LinkIcon/> 将相同的依赖包共享到多个项目中，避免重复下载和存储。
- **模块隔离：** 每个项目都有独立的 `node_modules` 目录，避免依赖冲突。
- **速度优势：** `PNPM` 的速度比 `NPM` 和` Yarn` 都要快，尤其是在管理大型项目时优势更加明显。

### 3.3 PNPM 的优缺点

#### 优点：

- **节省磁盘空间：** 通过硬链接技术，共享相同的依赖包，大幅减少磁盘占用。
- **速度极快：** `PNPM` 的安装速度领先于 `NPM` 和 `Yarn`，尤其是在网络环境较差时表现更加出色。
- **模块隔离：** 有效避免依赖包的冲突问题，提升项目的稳定性。

#### 缺点：

- **兼容性问题：** 虽然 `PNPM` **兼容** ` NPM`，但在某些特殊场景下，可能会遇到兼容性问题。
- **社区相对较小：** PNPM 是一个较新的工具，社区规模和生态还不如 NPM 和 Yarn 大。

## 四、三者对比

| 特性         | NPM                      | Yarn         | PNPM                       |
| :----------- | :----------------------- | :----------- | :------------------------- |
| 发布时间     | 2010 年                  | 2016 年      | 2017 年                    |
| 安装速度     | 相对较慢                 | 较快         | 极快                       |
| 并行安装     | 不支持                   | 支持         | 支持                       |
| 锁定文件     | `package-lock.json`      | `yarn.lock`  | `pnpm-lock.yaml`           |
| 磁盘空间使用 | 重复存储包，空间利用率低 | 缓存机制较好 | 通过硬链接节省空间         |
| 兼容性       | 广泛支持                 | 兼容 NPM     | 兼容 NPM，偶尔有兼容性问题 |
| 社区支持     | 最广泛                   | 强大         | 相对较小                   |

## 五、选择哪个包管理工具？

- **NPM：** 如果你习惯了 NPM，或者你需要一个拥有最大社区支持和包资源的工具，那么 NPM 依然是不错的选择。
- **Yarn：** 如果你注重安装速度和一致性，尤其是在团队协作中，Yarn 是一个值得考虑的替代方案。
- **PNPM：** 如果你的项目很大，依赖包众多，或者你想要最大限度地节省磁盘空间和提升安装速度，PNPM 可能是最佳选择。

## 六、总结

每个包管理工具都有其独特的优势和适用场景。

- `NPM` 作为最广泛使用的包管理工具，拥有庞大的社区支持；

- `Yarn` 则以速度和一致性著称，是团队协作中的理想选择；

- `PNPM` 通过硬链接技术带来了更高效的依赖管理方式，是大型项目中的强大工具；

选择合适的包管理工具，可以极大地提升开发效率和项目的可维护性。
