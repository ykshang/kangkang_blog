(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{497:function(s,a,t){s.exports=t.p+"assets/img/best_practices.1ade6507.png"},498:function(s,a,t){s.exports=t.p+"assets/img/best_practices1.5f32622f.png"},499:function(s,a,t){s.exports=t.p+"assets/img/best_practices2.d62fc1d4.png"},541:function(s,a,t){"use strict";t.r(a);var e=t(14),r=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"通过分支管理需求-代码的最佳实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过分支管理需求-代码的最佳实践"}},[s._v("#")]),s._v(" 通过分支管理需求，代码的最佳实践")]),s._v(" "),a("p",[s._v("假设有以下代码：")]),s._v(" "),a("p",[a("img",{attrs:{src:t(497),alt:"代码示意图"}})]),s._v(" "),a("ul",[a("li",[a("code",[s._v("master")]),s._v("分支是主分支，演进路线，代码都往主干分支合并")]),s._v(" "),a("li",[a("code",[s._v("L2020JS1201")]),s._v("分支，是版本分支，即拉出转测，准备2020年12月1号发布版本")]),s._v(" "),a("li",[a("code",[s._v("story#22306")]),s._v("分支，是我们做过的某一个需求，该需求已合并master分支，")])]),s._v(" "),a("p",[a("strong",[s._v("现在需求来了，"),a("code",[s._v("22306")]),s._v("这个需求要提前一个版本上线，在"),a("code",[s._v("L2020JS1201")]),s._v("版本里发布。")])]),s._v(" "),a("p",[s._v("我们分析一下场景:")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("story#22306")]),s._v("分支发育的晚于"),a("code",[s._v("L2020JS1201")]),s._v("分支")]),s._v(" "),a("li",[s._v("尽量操作简单、便捷")]),s._v(" "),a("li",[s._v("一旦出现问题，方便回退")]),s._v(" "),a("li",[s._v("不要出现多余的代码引入")])]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("说明")]),s._v(" "),a("p",[s._v("如果是"),a("code",[s._v("story#22306")]),s._v("分支早于"),a("code",[s._v("L2020JS1201")]),s._v("分支，那么问题就很简单，我们直接将"),a("code",[s._v("story#22306")]),s._v("分支压缩合并过去即可")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" merge story"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#22306 --squash")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("h2",{attrs:{id:"三种手段可以用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三种手段可以用"}},[s._v("#")]),s._v(" 三种手段可以用：")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[a("code",[s._v("merge")])]),s._v(" 合并分支")])]),s._v(" "),a("li",[a("p",[a("strong",[a("code",[s._v("rebase")])]),s._v(" 合并分支")])]),s._v(" "),a("li",[a("p",[a("strong",[a("code",[s._v("cherry-pick")])]),s._v(" 遴选代码合并过去")])])]),s._v(" "),a("p",[a("strong",[s._v("存在的问题")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("merge和rebase直接进行分支合并，都会先寻找一个公共祖先，直接合并分支可能会带来多余的代码。"),a("br"),s._v("\n我们查看提交历史发现，提交"),a("code",[s._v("C")]),s._v("是多余的，我们不想合入。")])]),s._v(" "),a("li",[a("p",[s._v("使用"),a("code",[s._v("cherry-pick")]),s._v("是个不错的选择，可以直接操作一段commit，将"),a("code",[s._v("story#22306")]),s._v("分支的提交直接遴选过去,同样问题也很明显，一旦发生问题，需要回退好几个提交的代码")])])]),s._v(" "),a("h2",{attrs:{id:"三种方案可利用特性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三种方案可利用特性"}},[s._v("#")]),s._v(" 三种方案可利用特性：")]),s._v(" "),a("ul",[a("li",[a("strong",[a("code",[s._v("merge --squash")])]),s._v(" 可以将一个分支压缩合并成一个提交到另外一个分支")]),s._v(" "),a("li",[a("strong",[a("code",[s._v("cherry-pick")])]),s._v(" 可以遴选一段提交")]),s._v(" "),a("li",[a("strong",[a("code",[s._v("rebase -i")])]),s._v(" 交互式变基，可以对提交进行增删改、合并。")])]),s._v(" "),a("h2",{attrs:{id:"最终两种推荐方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#最终两种推荐方案"}},[s._v("#")]),s._v(" 最终两种推荐方案：")]),s._v(" "),a("h3",{attrs:{id:"_1-创建临时分支-将story-22306分支整体压缩成一个提交-然后将该临时分支遴选到l2020js1201分支"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-创建临时分支-将story-22306分支整体压缩成一个提交-然后将该临时分支遴选到l2020js1201分支"}},[s._v("#")]),s._v(" 1. 创建临时分支，将"),a("code",[s._v("story#22306")]),s._v("分支整体压缩成一个提交，然后将该临时分支遴选到"),a("code",[s._v("L2020JS1201")]),s._v("分支")]),s._v(" "),a("p",[s._v("操作示意图：")]),s._v(" "),a("p",[a("img",{attrs:{src:t(498),alt:"代码示意图"}})]),s._v(" "),a("h4",{attrs:{id:"详细操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#详细操作"}},[s._v("#")]),s._v(" 详细操作")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("首先基于提交"),a("code",[s._v("C")]),s._v("创建"),a("code",[s._v("temp")]),s._v("临时分支")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" branch temp C\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("切换到该分支")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout temp\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("将"),a("code",[s._v("story#22306")]),s._v("分支压缩合并到该分支，生成一个新的提交"),a("code",[s._v("L")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" merge story"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#22306 --squash ")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("说明")]),s._v(" "),a("p",[s._v("为防止部分终端可能存在语法问题，可以将"),a("code",[s._v("story#22306")]),s._v("使用引号括起来，标识这是一个完整参数")])])]),s._v(" "),a("li",[a("p",[s._v("切换到"),a("code",[s._v("L2020JS1201")]),s._v("分支，将压缩合并产生的新提交"),a("code",[s._v("L")]),s._v("遴选过来，就算完成了。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout L2020JS1201\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" cherry-pick L \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"_2-将story-22306分支上的提交遴选到l2020js1201分支-然后将这部分提交利用交互式变基压缩成一个提交"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-将story-22306分支上的提交遴选到l2020js1201分支-然后将这部分提交利用交互式变基压缩成一个提交"}},[s._v("#")]),s._v(" 2. 将"),a("code",[s._v("story#22306")]),s._v("分支上的提交遴选到"),a("code",[s._v("L2020JS1201")]),s._v("分支，然后将这部分提交利用交互式变基压缩成一个提交")]),s._v(" "),a("p",[s._v("操作示意图：\n"),a("img",{attrs:{src:t(499),alt:"代码示意图"}})]),s._v(" "),a("ul",[a("li",[a("p",[s._v("首先使用"),a("code",[s._v("cherry-pick")]),s._v("将代码遴选到"),a("code",[s._v("L2020JS1201")]),s._v("分支")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" checkout L2020JS1201\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" cheerry-pick J"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("K\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("使用交互式变基将代码压缩成一个新的提交"),a("code",[s._v("L")]),s._v("，因为"),a("code",[s._v("J..K")]),s._v("共两个提交，所以参数为2。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" rebase "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" HEAD~2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])]),s._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[s._v("举一反三")]),s._v(" "),a("p",[s._v("某条分支上最新的一段提交压缩成为一个提交，使用reset也可以达到同样的效果")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" reset "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--soft")]),s._v(" I\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);